function writeLetter(t){var e=250,o=t.value.length;o>e&&(alert("Maksymalna długość komentarza to 250 znaków!"),t.value=t.value.substr(0,e),o=e),$("#lz").text(o)}function save(){var t=new Date,e=$("#title").val(),o=$("#author").val(),n=parseInt($("#year").val()),a=$("#publisher").val(),i=$("#comment").val();return e.length<2?void alert("Zbyt krótki tytuł!"):o.length<3?void alert("Zbyt krótki autor!"):isNaN(n)?void alert("Niepoprawny rok!"):a.length<2?void alert("Zbyt krótki wydawca!"):((-1e4>=n||n>t.getFullYear())&&alert("Rok powinien mieścić się w przedziale od -9999 do "+t.getFullYear()),loading(.8),void ajaxConnect("typ=1&t="+encodeURIComponent(e)+"&a="+encodeURIComponent(o)+"&y="+encodeURIComponent(n)+"&p="+encodeURIComponent(a)+"&c="+encodeURIComponent(i),1))}function delbook(t){loading(.8),ajaxConnect("typ=2&id="+parseInt(t))}function loading(t){var t=parseFloat(t);if(.8==t)$("#cover").css("display","block");else if(0!=t)return;$("#cover").animate({opacity:t},"fast",function(){$(this).css("opacity")<.8&&$(this).css("display","none")})}function ajaxConnect(t){$.ajax({url:"/pokazy/upload.php?callback=?",type:"post",data:t,dataType:"json",success:function(t){if(loading(0),1==t.error)return void alert("Wystąpił błąd!");if(1==t[0]){var e=$("#hdr").children(),o=$("tr"),n=o[o.length-1].className.substr(3),a='<tr id="row'+t[6]+'" class="row'+(1==n?2:1)+'" style="text-align:center"><td width="'+$(e[0]).width()+'" style="text-align:left">'+o.length+'.</td><td width="'+$(e[1]).width()+'">'+t[1]+'</td><td width="'+$(e[2]).width()+'">'+t[2]+'</td><td width="'+$(e[3]).width()+'">'+Math.abs(t[3])+" r."+(t[3]<0?" p.n.e.":"")+'</td><td width="'+$(e[4]).width()+'">'+t[4]+'</td><td width="'+$(e[5]).width()+'">'+t[5]+'</td><td width="'+$(e[6]).width()+'"><div class="delbut" onclick="delbook('+t[6]+')">[X]</div></td></tr>';$("table").css("border-bottom",0),$('<div id="temptab" style="display:none"><table border=1 style="border-top:0">'+a+"</table></div>").insertAfter("table").slideDown("slow",function(){$(a).appendTo("table"),$("#temptab").remove(),$("table").css("border-bottom","")})}else 2==t[0]&&($("#row"+t[1]).remove(),countels=0,$("tr").each(function(){countels&&($(this).children(":first-child").text(countels+"."),$(this).css("background-color",countels%2?"#E7E7E7":"#CDCDCD")),countels++}))},error:function(){loading(0),alert("Wystąpił błąd!")}})}function getHeight(){return Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight))}$(document).ready(function(){$("#cover img").css("margin-top",getHeight()/2-64+"px"),$("#cover").css("height",getHeight()+"px")});
